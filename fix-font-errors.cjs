// Script sửa lỗi font cụ thể trong file systemPrompt.js
// Chạy: node fix-font-errors.cjs

const fs = require('fs');

// Đọc file
let content = fs.readFileSync('./src/utils/systemPrompt.js', 'utf8');

console.log('Bắt đầu sửa lỗi font trong file systemPrompt.js...');
console.log(`Kích thước file ban đầu: ${content.length} ký tự`);

// Đếm số lỗi trước khi sửa
const errorsBefore = (content.match(/�/g) || []).length;
console.log(`Số ký tự lỗi (�) trước khi sửa: ${errorsBefore}`);

// Các pattern lỗi font cụ thể và cách sửa
// Format: [pattern bị lỗi, text đúng]
const specificFixes = [
    // Tên riêng và từ thường bị lỗi
    ['X�', 'Xã'],
    ['x�', 'xã'],
    ['L�', 'Lã'],
    ['l�', 'lã'],

    // Các từ có dấu bị mất
    ['ng�y', 'ngày'],
    ['Ng�y', 'Ngày'],
    ['th�ng', 'tháng'],
    ['Th�ng', 'Tháng'],
    ['n�m', 'năm'],
    ['N�m', 'Năm'],
    ['nh�n', 'nhân'],
    ['Nh�n', 'Nhân'],
    ['d�n', 'dân'],
    ['D�n', 'Dân'],
    ['ph�p', 'pháp'],
    ['Ph�p', 'Pháp'],
    ['nh�', 'nhà'],
    ['Nh�', 'Nhà'],
    ['n��c', 'nước'],
    ['N��c', 'Nước'],
    ['ng��i', 'người'],
    ['Ng��i', 'Người'],
    ['đ��c', 'được'],
    ['Đ��c', 'Được'],
    ['nh�ng', 'những'],
    ['Nh�ng', 'Những'],
    ['c�ng', 'công'],
    ['C�ng', 'Công'],
    ['h�nh', 'hành'],
    ['H�nh', 'Hành'],
    ['ch�nh', 'chính'],
    ['Ch�nh', 'Chính'],
    ['đ�i', 'đại'],
    ['Đ�i', 'Đại'],
    ['bi�u', 'biểu'],
    ['Bi�u', 'Biểu'],
    ['qu�c', 'quốc'],
    ['Qu�c', 'Quốc'],
    ['h�i', 'hội'],
    ['H�i', 'Hội'],
    ['đ�ng', 'đồng'],
    ['Đ�ng', 'Đồng'],
    ['tr�nh', 'trình'],
    ['Tr�nh', 'Trình'],
    ['hi�p', 'hiệp'],
    ['Hi�p', 'Hiệp'],
    ['th��ng', 'thương'],
    ['Th��ng', 'Thương'],
    ['ph�ng', 'phòng'],
    ['Ph�ng', 'Phòng'],
    ['phi�u', 'phiếu'],
    ['Phi�u', 'Phiếu'],
    ['th�n', 'thôn'],
    ['Th�n', 'Thôn'],
    ['gi�i', 'giới'],
    ['Gi�i', 'Giới'],
    ['thi�u', 'thiệu'],
    ['Thi�u', 'Thiệu'],
    ['�ng', 'ứng'],
    ['t�nh', 'tỉnh'],
    ['T�nh', 'Tỉnh'],
    ['huy�n', 'huyện'],
    ['Huy�n', 'Huyện'],
    ['th�', 'thủ'],
    ['Th�', 'Thủ'],
    ['t�c', 'tục'],
    ['T�c', 'Tục'],
    ['n�i', 'nội'],
    ['N�i', 'Nội'],
    ['dung', 'dung'],
    ['Dung', 'Dung'],
    ['h��ng', 'hướng'],
    ['H��ng', 'Hướng'],
    ['d�n', 'dẫn'],
    ['th�c', 'thực'],
    ['Th�c', 'Thực'],
    ['hi�n', 'hiện'],
    ['Hi�n', 'Hiện'],
    ['ho�ch', 'hoạch'],
    ['Ho�ch', 'Hoạch'],
    ['ki�m', 'kiểm'],
    ['Ki�m', 'Kiểm'],
    ['gi�m', 'giám'],
    ['Gi�m', 'Giám'],
    ['s�t', 'sát'],
    ['ti�p', 'tiếp'],
    ['Ti�p', 'Tiếp'],
    ['nh�n', 'nhận'],
    ['Nh�n', 'Nhận'],
    ['quy�t', 'quyết'],
    ['Quy�t', 'Quyết'],
    ['đ�nh', 'định'],
    ['Đ�nh', 'Định'],
    ['th�nh', 'thành'],
    ['Th�nh', 'Thành'],
    ['l�p', 'lập'],
    ['L�p', 'Lập'],
    ['s�ch', 'sách'],
    ['S�ch', 'Sách'],
    ['c�p', 'cấp'],
    ['C�p', 'Cấp'],
    ['ngh�', 'nghị'],
    ['Ngh�', 'Nghị'],
    ['lu�t', 'luật'],
    ['Lu�t', 'Luật'],
    ['s�a', 'sửa'],
    ['S�a', 'Sửa'],
    ['đ�i', 'đổi'],
    ['Đ�i', 'Đổi'],
    ['b�', 'bổ'],
    ['B�', 'Bổ'],
    ['m�t', 'một'],
    ['M�t', 'Một'],
    ['s�', 'số'],
    ['S�', 'Số'],
    ['đi�u', 'điều'],
    ['Đi�u', 'Điều'],
    ['kho�n', 'khoản'],
    ['Kho�n', 'Khoản'],
    ['c�a', 'của'],
    ['C�a', 'Của'],
    ['n�y', 'này'],
    ['N�y', 'Này'],
    ['c�c', 'các'],
    ['C�c', 'Các'],
    ['c�', 'cơ'],
    ['C�', 'Cơ'],
    ['đ�', 'đã'],
    ['ph�n', 'phân'],
    ['Ph�n', 'Phân'],
    ['l��ng', 'lượng'],
    ['L��ng', 'Lượng'],
    ['ph�i', 'phải'],
    ['Ph�i', 'Phải'],
    ['đ�m', 'đảm'],
    ['Đ�m', 'Đảm'],
    ['b�o', 'bảo'],
    ['B�o', 'Bảo'],
    ['t�', 'tỷ'],
    ['T�', 'Tỷ'],
    ['l�', 'lệ'],
    ['L�', 'Lệ'],
    ['ph�', 'phụ'],
    ['Ph�', 'Phụ'],
    ['n�', 'nữ'],
    ['N�', 'Nữ'],
    ['t�c', 'tộc'],
    ['thi�u', 'thiểu'],
    ['tr��ng', 'trường'],
    ['Tr��ng', 'Trường'],
    ['h�p', 'hợp'],
    ['H�p', 'Hợp'],
    ['kh�ng', 'không'],
    ['Kh�ng', 'Không'],
    ['th�a', 'thỏa'],
    ['Th�a', 'Thỏa'],
    ['thu�n', 'thuận'],
    ['Thu�n', 'Thuận'],
    ['v�n', 'vấn'],
    ['V�n', 'Vấn'],
    ['đ�', 'đề'],
    ['Đ�', 'Đề'],
    ['n�o', 'nào'],
    ['N�o', 'Nào'],
    ['th�', 'thì'],
    ['b�ng', 'bằng'],
    ['B�ng', 'Bằng'],
    ['gi�', 'giơ'],
    ['ho�c', 'hoặc'],
    ['Ho�c', 'Hoặc'],
    ['k�n', 'kín'],
    ['K�n', 'Kín'],
    ['t�', 'tổ'],
    ['T�', 'Tổ'],
    ['t�', 'từ'],
    ['T�', 'Từ'],
    ['đ�n', 'đến'],
    ['Đ�n', 'Đến'],
    ['đ�ng', 'đóng'],
    ['Đ�ng', 'Đóng'],
    ['d�u', 'dấu'],
    ['D�u', 'Dấu'],
    ['ch�', 'chỉ'],
    ['Ch�', 'Chỉ'],
    ['thu�c', 'thuộc'],
    ['Thu�c', 'Thuộc'],
    ['ph�n', 'phần'],
    ['Ph�n', 'Phần'],
    ['c�', 'có'],
    ['C�', 'Có'],
    ['m�t', 'mặt'],
    ['M�t', 'Mặt'],
    ['quy�n', 'quyền'],
    ['Quy�n', 'Quyền'],
    ['bi�n', 'biên'],
    ['Bi�n', 'Biên'],
    ['b�n', 'bản'],
    ['B�n', 'Bản'],
    ['g�i', 'gửi'],
    ['G�i', 'Gửi'],
    ['ch�m', 'chậm'],
    ['Ch�m', 'Chậm'],
    ['nh�t', 'nhất'],
    ['Nh�t', 'Nhất'],
    ['ti�n', 'tiến'],
    ['Ti�n', 'Tiến'],
    ['v�o', 'vào'],
    ['V�o', 'Vào'],
    ['k�t', 'kết'],
    ['K�t', 'Kết'],
    ['qu�', 'quả'],
    ['Qu�', 'Quả'],
    ['l�n', 'lần'],
    ['L�n', 'Lần'],
    ['th�', 'thứ'],
    ['Th�', 'Thứ'],
    ['tr��c', 'trước'],
    ['Tr��c', 'Trước'],
    ['đ�a', 'địa'],
    ['Đ�a', 'Địa'],
    ['ph��ng', 'phương'],
    ['tr�ch', 'trách'],
    ['Tr�ch', 'Trách'],
    ['nhi�m', 'nhiệm'],
    ['Nhi�m', 'Nhiệm'],
    ['th�ng', 'thông'],
    ['Th�ng', 'Thông'],
    ['l�m', 'làm'],
    ['L�m', 'Làm'],
    ['h�', 'hồ'],
    ['H�', 'Hồ'],
    ['s�', 'sơ'],
    ['S�', 'Sơ'],
    ['ph�', 'phó'],
    ['Ph�', 'Phó'],
    ['ch�', 'chủ'],
    ['Ch�', 'Chủ'],
    ['t�ch', 'tịch'],
    ['T�ch', 'Tịch'],
    ['th��ng', 'thường'],
    ['Th��ng', 'Thường'],
    ['tr�c', 'trực'],
    ['Tr�c', 'Trực'],
    ['l�nh', 'lĩnh'],
    ['L�nh', 'Lĩnh'],
    ['v�c', 'vực'],
    ['V�c', 'Vực'],
    ['ph�n', 'phản'],
    ['bi�n', 'biện'],
    ['Bi�n', 'Biện'],
    ['ph�i', 'phối'],
    ['ch�t', 'chặt'],
    ['ch�', 'chẽ'],
    ['v�i', 'với'],
    ['V�i', 'Với'],
    ['tr�', 'trì'],
    ['Tr�', 'Trì'],
    ['tri�u', 'triệu'],
    ['Tri�u', 'Triệu'],
    ['t�p', 'tập'],
    ['T�p', 'Tập'],
    ['di�n', 'diện'],
    ['Di�n', 'Diện'],
    ['b�y', 'bày'],
    ['B�y', 'Bày'],
    ['d�', 'dự'],
    ['D�', 'Dự'],
    ['ki�n', 'kiến'],
    ['Ki�n', 'Kiến'],
    ['c�u', 'cấu'],
    ['C�u', 'Cấu'],
    ['th�o', 'thảo'],
    ['Th�o', 'Thảo'],
    ['lu�n', 'luận'],
    ['Lu�n', 'Luận'],
    ['đ�', 'để'],
    ['l��', 'lựa'],
    ['L��', 'Lựa'],
    ['ch�n', 'chọn'],
    ['Ch�n', 'Chọn'],
    ['đ�', 'đủ'],
    ['Đ�', 'Đủ'],
    ['ti�u', 'tiêu'],
    ['Ti�u', 'Tiêu'],
    ['chu�n', 'chuẩn'],
    ['Chu�n', 'Chuẩn'],
    ['đ�p', 'đáp'],
    ['Đ�p', 'Đáp'],
    ['y�u', 'yêu'],
    ['Y�u', 'Yêu'],
    ['c�u', 'cầu'],
    ['qu�n', 'quản'],
    ['Qu�n', 'Quản'],
    ['l�', 'lý'],
    ['L�', 'Lý'],
    ['ch�p', 'chấp'],
    ['Ch�p', 'Chấp'],
    ['hi�n', 'hiến'],
    ['Hi�n', 'Hiến'],
    ['đ�ng', 'đảng'],
    ['Đ�ng', 'Đảng'],
    ['ch�', 'chí'],
    ['tr�', 'trị'],
    ['Tr�', 'Trị'],
    ['ch�', 'chế'],
    ['đ�', 'độ'],
    ['Đ�', 'Độ'],
    ['v�n', 'văn'],
    ['V�n', 'Văn'],
    ['đo�n', 'đoàn'],
    ['Đo�n', 'Đoàn'],
    ['ni�n', 'niên'],
    ['Ni�n', 'Niên'],
    ['li�n', 'liên'],
    ['Li�n', 'Liên'],
    ['gi', 'gia'],
    ['h�', 'hạ'],
    ['H�', 'Hạ'],
    ['t�ng', 'tầng'],
    ['T�ng', 'Tầng'],
    ['s�', 'sở'],
    ['S�', 'Sở'],
    ['đ�', 'đô'],
    ['th�', 'thị'],
    ['Th�', 'Thị'],
    ['n�ng', 'nông'],
    ['N�ng', 'Nông'],
    ['h�i', 'hải'],
    ['H�i', 'Hải'],
    ['đ�o', 'đảo'],
    ['Đ�o', 'Đảo'],
    ['đ�c', 'đặc'],
    ['Đ�c', 'Đặc'],
    ['kinh', 'kinh'],
    ['Kinh', 'Kinh'],
    ['t�', 'tế'],
    ['T�', 'Tế'],
    ['bi�t', 'biệt'],
    ['Bi�t', 'Biệt'],
    ['chi�n', 'chiến'],
    ['Chi�n', 'Chiến'],
    ['l��c', 'lược'],
    ['L��c', 'Lược'],
    ['đ�i', 'đãi'],
    ['v��t', 'vượt'],
    ['V��t', 'Vượt'],
    ['tr�i', 'trội'],
    ['m�i', 'mới'],
    ['M�i', 'Mới'],
    ['thu', 'thu'],
    ['Thu', 'Thu'],
    ['h�t', 'hút'],
    ['H�t', 'Hút'],
    ['đ�u', 'đầu'],
    ['Đ�u', 'Đầu'],
    ['t�', 'tư'],
    ['n�ng', 'nâng'],
    ['N�ng', 'Nâng'],
    ['cao', 'cao'],
    ['Cao', 'Cao'],
    ['n�ng', 'năng'],
    ['l�c', 'lực'],
    ['L�c', 'Lực'],
    ['c�nh', 'cạnh'],
    ['C�nh', 'Cạnh'],
    ['nh�m', 'nhằm'],
    ['Nh�m', 'Nhằm'],
    ['th�c', 'thúc'],
    ['đ�y', 'đẩy'],
    ['Đ�y', 'Đẩy'],
    ['ph�t', 'phát'],
    ['Ph�t', 'Phát'],
    ['tri�n', 'triển'],
    ['Tri�n', 'Triển'],
    ['v�ng', 'vùng'],
    ['V�ng', 'Vùng'],
    ['c�', 'cả'],
    ['kh�a', 'khóa'],
    ['Kh�a', 'Khóa'],
    ['ủy', 'ủy'],
    ['Ủy', 'Ủy'],
    ['tr�n', 'trận'],
    ['Tr�n', 'Trận'],
    ['công', 'công'],
    ['hành', 'hành'],
    ['chính', 'chính'],
    ['trình', 'trình'],
    ['người', 'người'],
    ['nước', 'nước'],
    ['được', 'được'],
    ['năm', 'năm'],
    ['ngày', 'ngày'],
    ['tháng', 'tháng'],
    ['v�', 'và'],
    ['V�', 'Và'],
    ['ho�', 'hòa'],
    ['Ho�', 'Hòa'],
    ['x�', 'xã'],
    ['đ�c', 'độc'],
    ['Đ�c', 'Độc'],
    ['l�p', 'lập'],
    ['L�p', 'Lập'],
    ['t�', 'tự'],
    ['T�', 'Tự'],
    ['h�nh', 'hạnh'],
    ['ph�c', 'phúc'],
    ['Ph�c', 'Phúc'],

    // Xóa ký tự lỗi còn lại
    ['�', ''],
];

let totalFixes = 0;

// Sắp xếp theo độ dài giảm dần để tránh conflict
const sortedFixes = specificFixes.sort((a, b) => b[0].length - a[0].length);

for (const [wrong, correct] of sortedFixes) {
    const escapedWrong = wrong.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    const regex = new RegExp(escapedWrong, 'g');
    const matches = content.match(regex);
    if (matches && matches.length > 0) {
        totalFixes += matches.length;
        content = content.replace(regex, correct);
        if (matches.length > 10) {
            console.log(`  - Sửa "${wrong}" -> "${correct}": ${matches.length} lần`);
        }
    }
}

console.log(`\nTổng số lần sửa: ${totalFixes}`);
console.log(`Kích thước file sau khi sửa: ${content.length} ký tự`);

// Đếm số lỗi còn lại
const errorsAfter = (content.match(/�/g) || []).length;
console.log(`Số ký tự lỗi (�) còn lại: ${errorsAfter}`);

// Ghi file
fs.writeFileSync('./src/utils/systemPrompt.js', content, 'utf8');
console.log('✅ Đã lưu file src/utils/systemPrompt.js');
